{"version":3,"sources":["webpack://frontend/./src/components/CarDetail.js"],"names":["CarDetail","state","alert","showAlert","errors","messages","car","manufacturer","model","production","color","power","mileage","comment","url","tooltipPlace","digitsOnly","e","charCode","preventDefault","getErrors","data","key","push","setTimeout","setState","length","join","changeCar","target","name","value","changeDate","date","console","log","dt","Date","toLocaleDateString","saveCar","axios","then","res","redirect","window","location","href","catch","err","response","getCar","ru","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;CAEA;;AACA;AACA;;IAEqBA,S;;;;;;;;;;;;;;oHACnBC,K,GAAQ;AACNC,WAAK,EAAE;AACLC,iBAAS,EAAE,KADN;AAELC,cAAM,EAAE,EAFH;AAGLC,gBAAQ,EAAE;AAHL,OADD;AAMNC,SAAG,EAAE;AACHC,oBAAY,EAAE,EADX;AAEHC,aAAK,EAAE,EAFJ;AAGHC,kBAAU,EAAE,EAHT;AAIHC,aAAK,EAAE,EAJJ;AAKHC,aAAK,EAAE,EALJ;AAMHC,eAAO,EAAE,EANN;AAOHC,eAAO,EAAE;AAPN;AANC,K,QAiBRC,G,GAAM,sB,QACNC,Y,GAAe,Q,QAOfC,U,GAAa,UAACC,CAAD,EAAO;AAClB,UAAIC,QAAQ,GAAGD,CAAC,CAACC,QAAjB,CADkB,CAElB;;AACA,UAAIA,QAAQ,GAAG,EAAX,IAAiBA,QAAQ,GAAG,EAAhC,EAAoC;AAClC;AACAD,SAAC,CAACE,cAAF;AACD;AACF,K,QAEDC,S,GAAY,UAACC,IAAD,EAAU;AACpB,UAAMjB,MAAM,GAAG,EAAf;;AACA,WAAK,IAAIkB,GAAT,IAAgBD,IAAhB,EAAsB;AACpBjB,cAAM,CAACmB,IAAP,CAAYF,IAAI,CAACC,GAAD,CAAhB;AACD;;AACD,aAAOlB,MAAP;AACD,K,QAEDD,S,GAAY,YAAM;AAChB,UAAI,MAAKF,KAAL,CAAWC,KAAX,CAAiBC,SAArB,EAAgC;AAC9BqB,kBAAU,CACR;AAAA,iBAAM,MAAKC,QAAL,CAAc;AAAEvB,iBAAK,EAAE;AAAEG,sBAAQ,EAAE,EAAZ;AAAgBD,oBAAM,EAAE,EAAxB;AAA4BD,uBAAS,EAAE;AAAvC;AAAT,WAAd,CAAN;AAAA,SADQ,EAER,IAFQ,CAAV;AAIA,YAAI,MAAKF,KAAL,CAAWC,KAAX,CAAiBE,MAAjB,CAAwBsB,MAAxB,GAAiC,CAArC,EACE,oBAAO,iDAAC,oDAAD;AAAO,iBAAO,EAAC;AAAf,WAAyB,MAAKzB,KAAL,CAAWC,KAAX,CAAiBE,MAAjB,CAAwBuB,IAAxB,CAA6B,IAA7B,CAAzB,CAAP;AACF,YAAI,MAAK1B,KAAL,CAAWC,KAAX,CAAiBG,QAAjB,CAA0BqB,MAA1B,GAAmC,CAAvC,EACE,oBAAO,iDAAC,oDAAD;AAAO,iBAAO,EAAC;AAAf,WAA0B,MAAKzB,KAAL,CAAWC,KAAX,CAAiBG,QAAjB,CAA0BsB,IAA1B,CAA+B,IAA/B,CAA1B,CAAP;AACH;;AACD,0BAAO,6DAAP;AACD,K,QAEDC,S,GAAY,UAACX,CAAD,EAAO;AACjB;AAEA,UAAMX,GAAG,mCACJ,MAAKL,KAAL,CAAWK,GADP,2BAENW,CAAC,CAACY,MAAF,CAASC,IAFH,EAEUb,CAAC,CAACY,MAAF,CAASE,KAFnB,EAAT,CAHiB,CAQjB;;;AAEA,YAAKN,QAAL,CAAc;AAAEnB,WAAG,EAAHA;AAAF,OAAd;AACD,K,QAED0B,U,GAAa,UAACC,IAAD,EAAU;AACrBC,aAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BF,IAA/B;AACA,UAAMG,EAAE,GAAG,IAAIC,IAAJ,CAASJ,IAAT,EAAeK,kBAAf,CAAkC,IAAlC,CAAX;AACAJ,aAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BC,EAA/B;;AACA,UAAM9B,GAAG,mCACJ,MAAKL,KAAL,CAAWK,GADP;AAEPG,kBAAU,EAAE,IAAI4B,IAAJ,CAASJ,IAAT,EAAeK,kBAAf,CAAkC,IAAlC;AAFL,QAAT;;AAIAJ,aAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8B7B,GAA9B;;AAEA,YAAKmB,QAAL,CAAc;AAAEnB,WAAG,EAAHA;AAAF,OAAd;AACD,K,QAEDiC,O,GAAU,UAACtB,CAAD,EAAO;AACfuB,uDAAA,CACQ,MAAK1B,GADb,EACkB;AAAER,WAAG,EAAE,MAAKL,KAAL,CAAWK;AAAlB,OADlB,EAEGmC,IAFH,CAEQ,UAACC,GAAD,EAAS;AACbR,eAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBO,GAAG,CAACrB,IAA3B;;AACA,YAAIqB,GAAG,CAACrB,IAAJ,CAASsB,QAAb,EAAuB;AACrBC,gBAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuBJ,GAAG,CAACrB,IAAJ,CAAS,UAAT,CAAvB;AACD;;AAED,cAAKI,QAAL,CAAc;AACZnB,aAAG,EAAEoC,GAAG,CAACrB,IADG;AAEZnB,eAAK,EAAE;AACLC,qBAAS,EAAE,IADN;AAELE,oBAAQ,EAAE,CAAC,oCAAD,CAFL;AAGLD,kBAAM,EAAE;AAHH;AAFK,SAAd;AAQD,OAhBH,EAiBG2C,KAjBH,CAiBS,UAACC,GAAD,EAAS;AACdd,eAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCa,GAAG,CAACC,QAAJ,CAAa5B,IAAhD;;AACA,cAAKI,QAAL,CAAc;AACZvB,eAAK,EAAE;AAAEG,oBAAQ,EAAE,EAAZ;AAAgBD,kBAAM,EAAE,MAAKgB,SAAL,CAAe4B,GAAG,CAACC,QAAJ,CAAa5B,IAA5B,CAAxB;AAA2DlB,qBAAS,EAAE;AAAtE;AADK,SAAd;AAGD,OAtBH;AAuBD,K,QAED+C,M,GAAS,YAAM;AACbV,uDAAA,CACQ,MAAK1B,GADb,EACkB,EADlB,EAEG2B,IAFH,CAEQ,UAACC,GAAD,EAAS;AACbR,eAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBO,GAAG,CAACrB,IAA1B;;AAEA,cAAKI,QAAL,CAAc;AAAEnB,aAAG,EAAEoC,GAAG,CAACrB;AAAX,SAAd;AACD,OANH,EAOG0B,KAPH,CAOS,UAACC,GAAD,EAAS;AACdd,eAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCa,GAAG,CAACC,QAAJ,CAAa5B,IAAhD;;AACA,cAAKI,QAAL,CAAc;AACZvB,eAAK,EAAE;AAAEG,oBAAQ,EAAE,EAAZ;AAAgBD,kBAAM,EAAE,MAAKgB,SAAL,CAAe4B,GAAG,CAACC,QAAJ,CAAa5B,IAA5B,CAAxB;AAA2DlB,qBAAS,EAAE;AAAtE;AADK,SAAd;AAGD,OAZH;AAaD,K;;;;;wCAtGmB;AAClB;AACA,WAAK+C,MAAL;AACD;;;6BAqGQ;AACP,0BACE,8DACG,KAAK/C,SAAL,EADH,eAEE,iDAAC,oDAAD,qBACE,iDAAC,0DAAD,uEADF,eAEE,iDAAC,yDAAD,qBACE,iDAAC,oDAAD,qBACE;AAAK,iBAAS,EAAC;AAAf,sBACE,iDAAC,oDAAD,qBACE,iDAAC,0DAAD;AAAY,iBAAS,EAAC;AAAtB,0FADF,eAEE;AACE,iBAAS,EAAC,oBADZ;AAEE,YAAI,EAAC,cAFP;AAGE,YAAI,EAAC,MAHP;AAIE,aAAK,EAAE,KAAKF,KAAL,CAAWK,GAAX,CAAeC,YAJxB;AAKE,gBAAQ,EAAE,KAAKqB;AALjB,QAFF,eASE,iDAAC,0DAAD;AAAY,iBAAS,EAAC;AAAtB,gDATF,eAUE;AACE,iBAAS,EAAC,oBADZ;AAEE,YAAI,EAAC,OAFP;AAGE,YAAI,EAAC,MAHP;AAIE,aAAK,EAAE,KAAK3B,KAAL,CAAWK,GAAX,CAAeE,KAJxB;AAKE,gBAAQ,EAAE,KAAKoB;AALjB,QAVF,eAkBE,iDAAC,0DAAD;AAAY,iBAAS,EAAC;AAAtB,+EAlBF,eAwBE,iDAAC,yDAAD;AACE,iBAAS,EAAC,QADZ,CAEE;AAFF;AAGE,cAAM,EAAEuB,2DAHV;AAIE,YAAI,EAAC,YAJP;AAKE,wBAAgB,EAAE,IALpB;AAME,gBAAQ,EAAE,KAAKnB,UANjB;AAOE,aAAK,EAAE,KAAK/B,KAAL,CAAWK,GAAX,CAAeG;AAPxB,QAxBF,eAkCE,iDAAC,0DAAD;AAAY,iBAAS,EAAC,OAAtB;AAA8B,YAAI,EAAC;AAAnC,oCAlCF,eAqCE;AACE,iBAAS,EAAC,oBADZ;AAEE,YAAI,EAAC,OAFP;AAGE,YAAI,EAAC,MAHP;AAIE,aAAK,EAAE,KAAKR,KAAL,CAAWK,GAAX,CAAeI,KAJxB;AAKE,gBAAQ,EAAE,KAAKkB;AALjB,QArCF,eA4CE,iDAAC,0DAAD;AAAY,iBAAS,EAAC,OAAtB;AAA8B,YAAI,EAAC;AAAnC,6EA5CF,eA+CE;AACE,iBAAS,EAAC,oBADZ;AAEE,YAAI,EAAC,OAFP;AAGE,YAAI,EAAC,MAHP;AAIE,iBAAS,EAAC,GAJZ;AAKE,aAAK,EAAE,KAAK3B,KAAL,CAAWK,GAAX,CAAeK,KAAf,GAAuB,KAAKV,KAAL,CAAWK,GAAX,CAAeK,KAAtC,GAA8C,EALvD;AAME,gBAAQ,EAAE,KAAKiB,SANjB;AAOE,kBAAU,EAAE,KAAKZ;AAPnB,QA/CF,eAwDE,iDAAC,0DAAD;AAAY,iBAAS,EAAC,OAAtB;AAA8B,YAAI,EAAC;AAAnC,gEAxDF,eA2DE;AACE,iBAAS,EAAC,oBADZ;AAEE,YAAI,EAAC,SAFP;AAGE,YAAI,EAAC,MAHP;AAIE,iBAAS,EAAC,IAJZ;AAKE,aAAK,EAAE,KAAKf,KAAL,CAAWK,GAAX,CAAeM,OAAf,GAAyB,KAAKX,KAAL,CAAWK,GAAX,CAAeM,OAAxC,GAAkD,EAL3D;AAME,gBAAQ,EAAE,KAAKgB,SANjB;AAOE,kBAAU,EAAE,KAAKZ;AAPnB,QA3DF,CADF,CADF,eAwEE;AAAK,iBAAS,EAAC;AAAf,sBACE,iDAAC,0DAAD;AAAY,iBAAS,EAAC;AAAtB,8EADF,eAEE,iDAAC,4DAAD;AACE,UAAE,EAAC,UADL;AAEE,YAAI,EAAC,GAFP;AAGE,aAAK,EAAE,KAAKf,KAAL,CAAWK,GAAX,CAAeO,OAHxB;AAIE,YAAI,EAAC,SAJP;AAKE,gBAAQ,EAAE,KAAKe;AALjB,QAFF,CAxEF,CADF,eAoFE,4DApFF,eAqFE;AAAK,iBAAS,EAAC;AAAf,sBACE;AAAK,iBAAS,EAAC;AAAf,sBACE,iDAAC,oDAAD;AACE,WAAG,EAAE,CADP;AAEE,iBAAS,EAAE,KAAKb,YAFlB;AAGE,eAAO,eAAE,iDAAC,qDAAD;AAAS,YAAE;AAAX;AAHX,sBAKE,iDAAC,qDAAD;AAAQ,eAAO,EAAC,SAAhB;AAA0B,iBAAS,EAAC,KAApC;AAA0C,eAAO,EAAE,KAAKwB;AAAxD,kEALF,CADF,CADF,CArFF,CAFF,CAFF,CADF;AA2GD;;;;EAzOoCa,4C","file":"src_components_CarDetail_js.js","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport { Card, Row, Form, Button, Alert, Tooltip, OverlayTrigger } from 'react-bootstrap';\nimport DatePicker from 'react-datepicker';\nimport { registerLocale } from 'react-datepicker';\n//import 'react-day-picker/lib/style.css';\nimport 'react-datepicker/dist/react-datepicker.css';\nimport { ru } from 'date-fns/locale/ru/index.js';\n\nexport default class CarDetail extends Component {\n  state = {\n    alert: {\n      showAlert: false,\n      errors: [],\n      messages: [],\n    },\n    car: {\n      manufacturer: '',\n      model: '',\n      production: '',\n      color: '',\n      power: '',\n      mileage: '',\n      comment: '',\n    },\n  };\n\n  url = '/testforjob/api/car/';\n  tooltipPlace = 'bottom';\n\n  componentDidMount() {\n    //registerLocale('ru', ru);\n    this.getCar();\n  }\n\n  digitsOnly = (e) => {\n    let charCode = e.charCode;\n    //console.log(charCode);\n    if (charCode < 48 || charCode > 57) {\n      // digits only\n      e.preventDefault();\n    }\n  };\n\n  getErrors = (data) => {\n    const errors = [];\n    for (let key in data) {\n      errors.push(data[key]);\n    }\n    return errors;\n  };\n\n  showAlert = () => {\n    if (this.state.alert.showAlert) {\n      setTimeout(\n        () => this.setState({ alert: { messages: [], errors: [], showAlert: false } }),\n        5000\n      );\n      if (this.state.alert.errors.length > 0)\n        return <Alert variant=\"danger\">{this.state.alert.errors.join('. ')}</Alert>;\n      if (this.state.alert.messages.length > 0)\n        return <Alert variant=\"primary\">{this.state.alert.messages.join('. ')}</Alert>;\n    }\n    return <div />;\n  };\n\n  changeCar = (e) => {\n    //console.log('changeCar', e);\n\n    const car = {\n      ...this.state.car,\n      [e.target.name]: e.target.value,\n    };\n\n    //console.log('changeCar', car);\n\n    this.setState({ car });\n  };\n\n  changeDate = (date) => {\n    console.log('changeDate date', date);\n    const dt = new Date(date).toLocaleDateString('ru');\n    console.log('changeDate date', dt);\n    const car = {\n      ...this.state.car,\n      production: new Date(date).toLocaleDateString('ru'),\n    };\n    console.log('changeDate car', car);\n\n    this.setState({ car });\n  };\n\n  saveCar = (e) => {\n    axios\n      .post(this.url, { car: this.state.car })\n      .then((res) => {\n        console.log('saveCar', res.data);\n        if (res.data.redirect) {\n          window.location.href = res.data['redirect'];\n        }\n\n        this.setState({\n          car: res.data,\n          alert: {\n            showAlert: true,\n            messages: ['Информация об автомобиле сохранена'],\n            errors: [],\n          },\n        });\n      })\n      .catch((err) => {\n        console.log('geCarDetail saveCar', err.response.data);\n        this.setState({\n          alert: { messages: [], errors: this.getErrors(err.response.data), showAlert: true },\n        });\n      });\n  };\n\n  getCar = () => {\n    axios\n      .post(this.url, {})\n      .then((res) => {\n        console.log('getCar', res.data);\n\n        this.setState({ car: res.data });\n      })\n      .catch((err) => {\n        console.log('getCarDetail getCar', err.response.data);\n        this.setState({\n          alert: { messages: [], errors: this.getErrors(err.response.data), showAlert: true },\n        });\n      });\n  };\n\n  render() {\n    return (\n      <div>\n        {this.showAlert()}\n        <Card>\n          <Card.Title>Автомобиль</Card.Title>\n          <Card.Body>\n            <Row>\n              <div className=\"col-6\">\n                <Row>\n                  <Form.Label className=\"col-5\">Производитель</Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"manufacturer\"\n                    type=\"text\"\n                    value={this.state.car.manufacturer}\n                    onChange={this.changeCar}\n                  />\n                  <Form.Label className=\"col-5\">Модель</Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"model\"\n                    type=\"text\"\n                    value={this.state.car.model}\n                    onChange={this.changeCar}\n                  />\n\n                  <Form.Label className=\"col-5\">Дата выпуска</Form.Label>\n                  {/* <OverlayTrigger\n                    key={1}\n                    placement={this.tooltipPlace}\n                    overlay={<Tooltip id={`tooltip-1`}>Дата выпуска в формате dd.mm.yyy</Tooltip>}\n                  > */}\n                  <DatePicker\n                    className=\"col-11\"\n                    //format=\"dd.MM.yyyy\"\n                    locale={ru}\n                    name=\"production\"\n                    showYearDropdown={true}\n                    onChange={this.changeDate}\n                    value={this.state.car.production}\n                  />\n                  {/* </OverlayTrigger> */}\n                  <Form.Label className=\"col-5\" name=\"color\">\n                    Цвет\n                  </Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"color\"\n                    type=\"text\"\n                    value={this.state.car.color}\n                    onChange={this.changeCar}\n                  />\n                  <Form.Label className=\"col-5\" name=\"age\">\n                    Мощность (л.с.)\n                  </Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"power\"\n                    type=\"text\"\n                    maxLength=\"3\"\n                    value={this.state.car.power ? this.state.car.power : ''}\n                    onChange={this.changeCar}\n                    onKeyPress={this.digitsOnly}\n                  />\n                  <Form.Label className=\"col-5\" name=\"age\">\n                    Пробег (км.)\n                  </Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"mileage\"\n                    type=\"text\"\n                    maxLength=\"10\"\n                    value={this.state.car.mileage ? this.state.car.mileage : ''}\n                    onChange={this.changeCar}\n                    onKeyPress={this.digitsOnly}\n                  />\n                </Row>\n              </div>\n              <div className=\"col-6\">\n                <Form.Label className=\"col-5\">Комментарий</Form.Label>\n                <Form.Control\n                  as=\"textarea\"\n                  rows=\"7\"\n                  value={this.state.car.comment}\n                  name=\"comment\"\n                  onChange={this.changeCar}\n                />\n              </div>\n            </Row>\n            <hr />\n            <div className=\"row spacer\">\n              <div className=\"col-12\">\n                <OverlayTrigger\n                  key={2}\n                  placement={this.tooltipPlace}\n                  overlay={<Tooltip id={`tooltip-2`}>Сохранить информацию об автомобиле</Tooltip>}\n                >\n                  <Button variant=\"primary\" className=\"col\" onClick={this.saveCar}>\n                    Сохранить\n                  </Button>\n                </OverlayTrigger>\n              </div>\n            </div>\n          </Card.Body>\n        </Card>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}