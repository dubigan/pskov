{"version":3,"sources":["webpack://frontend/./src/components/CarDetail.js"],"names":["CarDetail","state","alert","showAlert","errors","messages","car","manufacturer","model","production","color","power","mileage","comment","url","tooltipPlace","digitsOnly","e","charCode","preventDefault","getErrors","data","key","push","setTimeout","setState","length","join","changeCar","target","name","value","changeDate","date","console","log","dt","Date","toLocaleDateString","saveCar","axios","then","res","redirect","window","location","href","catch","err","response","getCar","ru","Component"],"mappings":"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","file":"src_components_CarDetail_js.js","sourcesContent":["import React, { Component } from 'react';\r\nimport axios from 'axios';\r\nimport { Card, Row, Form, Button, Alert, Tooltip, OverlayTrigger } from 'react-bootstrap';\r\nimport DatePicker from 'react-datepicker';\r\nimport { registerLocale } from 'react-datepicker';\r\n//import 'react-day-picker/lib/style.css';\r\nimport 'react-datepicker/dist/react-datepicker.css';\r\nimport { ru } from 'date-fns/locale/ru/index.js';\r\n\r\nexport default class CarDetail extends Component {\r\n  state = {\r\n    alert: {\r\n      showAlert: false,\r\n      errors: [],\r\n      messages: [],\r\n    },\r\n    car: {\r\n      manufacturer: '',\r\n      model: '',\r\n      production: '',\r\n      color: '',\r\n      power: '',\r\n      mileage: '',\r\n      comment: '',\r\n    },\r\n  };\r\n\r\n  url = '/testforjob/api/car/';\r\n  tooltipPlace = 'bottom';\r\n\r\n  componentDidMount() {\r\n    //registerLocale('ru', ru);\r\n    this.getCar();\r\n  }\r\n\r\n  digitsOnly = (e) => {\r\n    let charCode = e.charCode;\r\n    //console.log(charCode);\r\n    if (charCode < 48 || charCode > 57) {\r\n      // digits only\r\n      e.preventDefault();\r\n    }\r\n  };\r\n\r\n  getErrors = (data) => {\r\n    const errors = [];\r\n    for (let key in data) {\r\n      errors.push(data[key]);\r\n    }\r\n    return errors;\r\n  };\r\n\r\n  showAlert = () => {\r\n    if (this.state.alert.showAlert) {\r\n      setTimeout(\r\n        () => this.setState({ alert: { messages: [], errors: [], showAlert: false } }),\r\n        5000\r\n      );\r\n      if (this.state.alert.errors.length > 0)\r\n        return <Alert variant=\"danger\">{this.state.alert.errors.join('. ')}</Alert>;\r\n      if (this.state.alert.messages.length > 0)\r\n        return <Alert variant=\"primary\">{this.state.alert.messages.join('. ')}</Alert>;\r\n    }\r\n    return <div />;\r\n  };\r\n\r\n  changeCar = (e) => {\r\n    //console.log('changeCar', e);\r\n\r\n    const car = {\r\n      ...this.state.car,\r\n      [e.target.name]: e.target.value,\r\n    };\r\n\r\n    //console.log('changeCar', car);\r\n\r\n    this.setState({ car });\r\n  };\r\n\r\n  changeDate = (date) => {\r\n    console.log('changeDate date', date);\r\n    const dt = new Date(date).toLocaleDateString('ru');\r\n    console.log('changeDate date', dt);\r\n    const car = {\r\n      ...this.state.car,\r\n      production: new Date(date).toLocaleDateString('ru'),\r\n    };\r\n    console.log('changeDate car', car);\r\n\r\n    this.setState({ car });\r\n  };\r\n\r\n  saveCar = (e) => {\r\n    axios\r\n      .post(this.url, { car: this.state.car })\r\n      .then((res) => {\r\n        console.log('saveCar', res.data);\r\n        if (res.data.redirect) {\r\n          window.location.href = res.data['redirect'];\r\n        }\r\n\r\n        this.setState({\r\n          car: res.data,\r\n          alert: {\r\n            showAlert: true,\r\n            messages: ['Информация об автомобиле сохранена'],\r\n            errors: [],\r\n          },\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        console.log('geCarDetail saveCar', err.response.data);\r\n        this.setState({\r\n          alert: { messages: [], errors: this.getErrors(err.response.data), showAlert: true },\r\n        });\r\n      });\r\n  };\r\n\r\n  getCar = () => {\r\n    axios\r\n      .post(this.url, {})\r\n      .then((res) => {\r\n        console.log('getCar', res.data);\r\n\r\n        this.setState({ car: res.data });\r\n      })\r\n      .catch((err) => {\r\n        console.log('getCarDetail getCar', err.response.data);\r\n        this.setState({\r\n          alert: { messages: [], errors: this.getErrors(err.response.data), showAlert: true },\r\n        });\r\n      });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        {this.showAlert()}\r\n        <Card>\r\n          <Card.Title>Автомобиль</Card.Title>\r\n          <Card.Body>\r\n            <Row>\r\n              <div className=\"col-6\">\r\n                <Row>\r\n                  <Form.Label className=\"col-5\">Производитель</Form.Label>\r\n                  <input\r\n                    className=\"form-control col-6\"\r\n                    name=\"manufacturer\"\r\n                    type=\"text\"\r\n                    value={this.state.car.manufacturer}\r\n                    onChange={this.changeCar}\r\n                  />\r\n                  <Form.Label className=\"col-5\">Модель</Form.Label>\r\n                  <input\r\n                    className=\"form-control col-6\"\r\n                    name=\"model\"\r\n                    type=\"text\"\r\n                    value={this.state.car.model}\r\n                    onChange={this.changeCar}\r\n                  />\r\n\r\n                  <Form.Label className=\"col-5\">Дата выпуска</Form.Label>\r\n                  {/* <OverlayTrigger\r\n                    key={1}\r\n                    placement={this.tooltipPlace}\r\n                    overlay={<Tooltip id={`tooltip-1`}>Дата выпуска в формате dd.mm.yyy</Tooltip>}\r\n                  > */}\r\n                  <DatePicker\r\n                    className=\"col-11\"\r\n                    //format=\"dd.MM.yyyy\"\r\n                    locale={ru}\r\n                    name=\"production\"\r\n                    showYearDropdown={true}\r\n                    onChange={this.changeDate}\r\n                    value={this.state.car.production}\r\n                  />\r\n                  {/* </OverlayTrigger> */}\r\n                  <Form.Label className=\"col-5\" name=\"color\">\r\n                    Цвет\r\n                  </Form.Label>\r\n                  <input\r\n                    className=\"form-control col-6\"\r\n                    name=\"color\"\r\n                    type=\"text\"\r\n                    value={this.state.car.color}\r\n                    onChange={this.changeCar}\r\n                  />\r\n                  <Form.Label className=\"col-5\" name=\"age\">\r\n                    Мощность (л.с.)\r\n                  </Form.Label>\r\n                  <input\r\n                    className=\"form-control col-6\"\r\n                    name=\"power\"\r\n                    type=\"text\"\r\n                    maxLength=\"3\"\r\n                    value={this.state.car.power ? this.state.car.power : ''}\r\n                    onChange={this.changeCar}\r\n                    onKeyPress={this.digitsOnly}\r\n                  />\r\n                  <Form.Label className=\"col-5\" name=\"age\">\r\n                    Пробег (км.)\r\n                  </Form.Label>\r\n                  <input\r\n                    className=\"form-control col-6\"\r\n                    name=\"mileage\"\r\n                    type=\"text\"\r\n                    maxLength=\"10\"\r\n                    value={this.state.car.mileage ? this.state.car.mileage : ''}\r\n                    onChange={this.changeCar}\r\n                    onKeyPress={this.digitsOnly}\r\n                  />\r\n                </Row>\r\n              </div>\r\n              <div className=\"col-6\">\r\n                <Form.Label className=\"col-5\">Комментарий</Form.Label>\r\n                <Form.Control\r\n                  as=\"textarea\"\r\n                  rows=\"7\"\r\n                  value={this.state.car.comment}\r\n                  name=\"comment\"\r\n                  onChange={this.changeCar}\r\n                />\r\n              </div>\r\n            </Row>\r\n            <hr />\r\n            <div className=\"row spacer\">\r\n              <div className=\"col-12\">\r\n                <OverlayTrigger\r\n                  key={2}\r\n                  placement={this.tooltipPlace}\r\n                  overlay={<Tooltip id={`tooltip-2`}>Сохранить информацию об автомобиле</Tooltip>}\r\n                >\r\n                  <Button variant=\"primary\" className=\"col\" onClick={this.saveCar}>\r\n                    Сохранить\r\n                  </Button>\r\n                </OverlayTrigger>\r\n              </div>\r\n            </div>\r\n          </Card.Body>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}