{"version":3,"sources":["webpack://frontend/./src/components/CarDetail.js"],"names":["CarDetail","state","alert","showAlert","errors","messages","car","manufacturer","model","production","color","power","mileage","comment","url","tooltipPlace","digitsOnly","e","charCode","preventDefault","getErrors","data","key","push","setTimeout","setState","length","variant","join","changeCar","target","name","value","changeDate","date","console","log","dt","Date","toLocaleDateString","saveCar","axios","then","res","redirect","window","location","href","catch","err","response","getCar","this","className","type","onChange","locale","ru","showYearDropdown","maxLength","onKeyPress","as","rows","placement","overlay","id","onClick","Component"],"mappings":"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","file":"509.js","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport { Card, Row, Form, Button, Alert, Tooltip, OverlayTrigger } from 'react-bootstrap';\nimport DatePicker from 'react-datepicker';\nimport { registerLocale } from 'react-datepicker';\n//import 'react-day-picker/lib/style.css';\nimport 'react-datepicker/dist/react-datepicker.css';\nimport { ru } from 'date-fns/locale/ru/index.js';\n\nexport default class CarDetail extends Component {\n  state = {\n    alert: {\n      showAlert: false,\n      errors: [],\n      messages: [],\n    },\n    car: {\n      manufacturer: '',\n      model: '',\n      production: '',\n      color: '',\n      power: '',\n      mileage: '',\n      comment: '',\n    },\n  };\n\n  url = '/testforjob/api/car/';\n  tooltipPlace = 'bottom';\n\n  componentDidMount() {\n    //registerLocale('ru', ru);\n    this.getCar();\n  }\n\n  digitsOnly = (e) => {\n    let charCode = e.charCode;\n    //console.log(charCode);\n    if (charCode < 48 || charCode > 57) {\n      // digits only\n      e.preventDefault();\n    }\n  };\n\n  getErrors = (data) => {\n    const errors = [];\n    for (let key in data) {\n      errors.push(data[key]);\n    }\n    return errors;\n  };\n\n  showAlert = () => {\n    if (this.state.alert.showAlert) {\n      setTimeout(\n        () => this.setState({ alert: { messages: [], errors: [], showAlert: false } }),\n        5000\n      );\n      if (this.state.alert.errors.length > 0)\n        return <Alert variant=\"danger\">{this.state.alert.errors.join('. ')}</Alert>;\n      if (this.state.alert.messages.length > 0)\n        return <Alert variant=\"primary\">{this.state.alert.messages.join('. ')}</Alert>;\n    }\n    return <div />;\n  };\n\n  changeCar = (e) => {\n    //console.log('changeCar', e);\n\n    const car = {\n      ...this.state.car,\n      [e.target.name]: e.target.value,\n    };\n\n    //console.log('changeCar', car);\n\n    this.setState({ car });\n  };\n\n  changeDate = (date) => {\n    console.log('changeDate date', date);\n    const dt = new Date(date).toLocaleDateString('ru');\n    console.log('changeDate date', dt);\n    const car = {\n      ...this.state.car,\n      production: new Date(date).toLocaleDateString('ru'),\n    };\n    console.log('changeDate car', car);\n\n    this.setState({ car });\n  };\n\n  saveCar = (e) => {\n    axios\n      .post(this.url, { car: this.state.car })\n      .then((res) => {\n        console.log('saveCar', res.data);\n        if (res.data.redirect) {\n          window.location.href = res.data['redirect'];\n        }\n\n        this.setState({\n          car: res.data,\n          alert: {\n            showAlert: true,\n            messages: ['Информация об автомобиле сохранена'],\n            errors: [],\n          },\n        });\n      })\n      .catch((err) => {\n        console.log('geCarDetail saveCar', err.response.data);\n        this.setState({\n          alert: { messages: [], errors: this.getErrors(err.response.data), showAlert: true },\n        });\n      });\n  };\n\n  getCar = () => {\n    axios\n      .post(this.url, {})\n      .then((res) => {\n        console.log('getCar', res.data);\n\n        this.setState({ car: res.data });\n      })\n      .catch((err) => {\n        console.log('getCarDetail getCar', err.response.data);\n        this.setState({\n          alert: { messages: [], errors: this.getErrors(err.response.data), showAlert: true },\n        });\n      });\n  };\n\n  render() {\n    return (\n      <div>\n        {this.showAlert()}\n        <Card>\n          <Card.Title>Автомобиль</Card.Title>\n          <Card.Body>\n            <Row>\n              <div className=\"col-6\">\n                <Row>\n                  <Form.Label className=\"col-5\">Производитель</Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"manufacturer\"\n                    type=\"text\"\n                    value={this.state.car.manufacturer}\n                    onChange={this.changeCar}\n                  />\n                  <Form.Label className=\"col-5\">Модель</Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"model\"\n                    type=\"text\"\n                    value={this.state.car.model}\n                    onChange={this.changeCar}\n                  />\n\n                  <Form.Label className=\"col-5\">Дата выпуска</Form.Label>\n                  {/* <OverlayTrigger\n                    key={1}\n                    placement={this.tooltipPlace}\n                    overlay={<Tooltip id={`tooltip-1`}>Дата выпуска в формате dd.mm.yyy</Tooltip>}\n                  > */}\n                  <DatePicker\n                    className=\"col-11\"\n                    //format=\"dd.MM.yyyy\"\n                    locale={ru}\n                    name=\"production\"\n                    showYearDropdown={true}\n                    onChange={this.changeDate}\n                    value={this.state.car.production}\n                  />\n                  {/* </OverlayTrigger> */}\n                  <Form.Label className=\"col-5\" name=\"color\">\n                    Цвет\n                  </Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"color\"\n                    type=\"text\"\n                    value={this.state.car.color}\n                    onChange={this.changeCar}\n                  />\n                  <Form.Label className=\"col-5\" name=\"age\">\n                    Мощность (л.с.)\n                  </Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"power\"\n                    type=\"text\"\n                    maxLength=\"3\"\n                    value={this.state.car.power ? this.state.car.power : ''}\n                    onChange={this.changeCar}\n                    onKeyPress={this.digitsOnly}\n                  />\n                  <Form.Label className=\"col-5\" name=\"age\">\n                    Пробег (км.)\n                  </Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"mileage\"\n                    type=\"text\"\n                    maxLength=\"10\"\n                    value={this.state.car.mileage ? this.state.car.mileage : ''}\n                    onChange={this.changeCar}\n                    onKeyPress={this.digitsOnly}\n                  />\n                </Row>\n              </div>\n              <div className=\"col-6\">\n                <Form.Label className=\"col-5\">Комментарий</Form.Label>\n                <Form.Control\n                  as=\"textarea\"\n                  rows=\"7\"\n                  value={this.state.car.comment}\n                  name=\"comment\"\n                  onChange={this.changeCar}\n                />\n              </div>\n            </Row>\n            <hr />\n            <div className=\"row spacer\">\n              <div className=\"col-12\">\n                <OverlayTrigger\n                  key={2}\n                  placement={this.tooltipPlace}\n                  overlay={<Tooltip id={`tooltip-2`}>Сохранить информацию об автомобиле</Tooltip>}\n                >\n                  <Button variant=\"primary\" className=\"col\" onClick={this.saveCar}>\n                    Сохранить\n                  </Button>\n                </OverlayTrigger>\n              </div>\n            </div>\n          </Card.Body>\n        </Card>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}