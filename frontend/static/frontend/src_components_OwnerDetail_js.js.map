{"version":3,"sources":["webpack://frontend/./src/components/OwnerDetail.js"],"names":["OwnerDetail","state","messages","owner","id","cars","name","patronymic","last_name","gender","age","comment","url","tooltipPlace","digitsOnly","e","charCode","preventDefault","getErrors","data","Object","keys","map","key","type","message","getOwner","axios","then","res","setState","catch","err","response","saveOwner","changeOwner","target","value","btnNewCarClick","btn_add","window","location","pathname","owner_pk","redirect","href","Component"],"mappings":"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","file":"src_components_OwnerDetail_js.js","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport {\n  Card,\n  Row,\n  Form,\n  Button,\n  Col,\n  Tooltip,\n  OverlayTrigger,\n} from \"react-bootstrap\";\nimport Cars from \"./Cars\";\nimport Alerts from \"./Alerts\";\n\nexport default class OwnerDetail extends Component {\n  state = {\n    messages: [],\n    owner: {\n      id: -10, // indicate new owner, -1 is not acceptable\n      cars: [],\n      name: \"\",\n      patronymic: \"\",\n      last_name: \"\",\n      gender: \"\",\n      age: \"\",\n      comment: \"\",\n    },\n  };\n\n  url = \"/testforjob/api/owner/\";\n  tooltipPlace = \"bottom\";\n\n  componentDidMount() {\n    this.getOwner();\n  }\n\n  digitsOnly = (e) => {\n    let charCode = e.charCode;\n    //console.log(charCode);\n    if (charCode < 48 || charCode > 57) {\n      // digits only\n      e.preventDefault();\n    }\n  };\n\n  getErrors = (data) => {\n    return Object.keys(data).map((key) => {\n      return { type: \"error\", message: data[key] };\n    });\n  };\n\n  getOwner = () => {\n    axios\n      .post(this.url, {})\n      .then((res) => {\n        //console.log('getOwner', res.data);\n\n        const owner = {\n          ...res.data,\n          id: res.data[\"id\"] ? res.data[\"id\"] : -10,\n        };\n        //console.log(\"getOwner\", owner);\n        this.setState({ owner: owner });\n      })\n      .catch((err) => {\n        //console.log(\"getOwnerDetail getOwner\", err.response.data);\n        this.setState({\n          messages: this.getErrors(err.response.data),\n        });\n      });\n  };\n\n  saveOwner = () => {\n    axios\n      .post(this.url, { owner: this.state.owner })\n      .then((res) => {\n        //console.log('saveOwner', res.data);\n\n        this.setState({\n          owner: res.data,\n          messages: [\n            { type: \"success\", message: \"Информация о владельце сохранена\" },\n          ],\n        });\n      })\n      .catch((err) => {\n        //console.log(\"getOwnerDetail saveOwner\", err.response.data);\n        this.setState({\n          messages: this.getErrors(err.response.data),\n        });\n      });\n  };\n\n  changeOwner = (e) => {\n    let owner;\n    switch (e.target.name) {\n      case \"gender-f\":\n        owner = {\n          ...this.state.owner,\n          gender: \"f\",\n        };\n        break;\n      case \"gender-m\":\n        owner = {\n          ...this.state.owner,\n          gender: \"m\",\n        };\n        break;\n      default:\n        owner = {\n          ...this.state.owner,\n          [e.target.name]: e.target.value,\n        };\n    }\n    //console.log('changeOwner', owner);\n\n    this.setState({ owner });\n  };\n\n  btnNewCarClick = () => {\n    axios\n      .post(this.url, {\n        btn_add: \"\",\n        url: window.location.pathname,\n        owner_pk: this.state.owner.id,\n      })\n      .then((res) => {\n        if (res.data.redirect) {\n          window.location.href = res.data[\"redirect\"];\n        }\n      })\n      .catch((err) => {\n        //console.log(\"btnAddClick\", err.response.data);\n        this.setState({\n          messages: this.getErrors(err.response.data),\n        });\n      });\n  };\n\n  render() {\n    return (\n      <div>\n        <Alerts messages={this.state.messages} />\n        <Card>\n          <Card.Title>Автовладелец</Card.Title>\n          <Card.Body>\n            <Row>\n              <div className=\"col-5\">\n                <Row>\n                  <Form.Label className=\"col-4\">Имя</Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"name\"\n                    type=\"text\"\n                    value={this.state.owner.name ? this.state.owner.name : \"\"}\n                    onChange={this.changeOwner}\n                  />\n                  <Form.Label className=\"col-4\">Отчество</Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"patronymic\"\n                    type=\"text\"\n                    value={\n                      this.state.owner.patronymic\n                        ? this.state.owner.patronymic\n                        : \"\"\n                    }\n                    onChange={this.changeOwner}\n                  />\n                  <Form.Label className=\"col-4\">Фамилия</Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"last_name\"\n                    type=\"text\"\n                    value={\n                      this.state.owner.last_name\n                        ? this.state.owner.last_name\n                        : \"\"\n                    }\n                    onChange={this.changeOwner}\n                  />\n                  <Form.Label className=\"col-4\" name=\"gender\">\n                    Пол\n                  </Form.Label>\n                  <Row className=\"col-6\">\n                    <Form.Label className=\"col-1\" name=\"gender-m\">\n                      <small>М</small>\n                    </Form.Label>\n                    <input\n                      className=\"form-control col-1 border-0\"\n                      name=\"gender-m\"\n                      type=\"radio\"\n                      checked={this.state.owner.gender === \"m\" ? 1 : 0}\n                      onChange={this.changeOwner}\n                    />\n                    <Form.Label className=\"col-1\" name=\"gender-f\">\n                      <small>Ж</small>\n                    </Form.Label>\n                    <input\n                      className=\"form-control col-1 border-0\"\n                      name=\"gender-f\"\n                      type=\"radio\"\n                      checked={this.state.owner.gender === \"f\" ? 1 : 0}\n                      onChange={this.changeOwner}\n                    />\n                  </Row>\n                  <Form.Label className=\"col-4\" name=\"age\">\n                    Возраст\n                  </Form.Label>\n                  <input\n                    className=\"form-control col-6\"\n                    name=\"age\"\n                    type=\"text\"\n                    maxLength=\"3\"\n                    value={this.state.owner.age ? this.state.owner.age : \"\"}\n                    onChange={this.changeOwner}\n                    onKeyPress={this.digitsOnly}\n                  />\n                </Row>\n              </div>\n              <div className=\"col-7\">\n                <Form.Label className=\"col-4\">Комментарий</Form.Label>\n                <Form.Control\n                  as=\"textarea\"\n                  rows=\"6\"\n                  value={this.state.owner.comment}\n                  name=\"comment\"\n                  onChange={this.changeOwner}\n                />\n              </div>\n            </Row>\n            <hr />\n            <div className=\"row spacer\">\n              <div className=\"col-12\">\n                <OverlayTrigger\n                  key={1}\n                  placement={this.tooltipPlace}\n                  overlay={\n                    <Tooltip id={`tooltip-1`}>\n                      Сохранить информацию об автовладельце\n                    </Tooltip>\n                  }\n                >\n                  <Button\n                    variant=\"primary\"\n                    className=\"col\"\n                    onClick={this.saveOwner}\n                  >\n                    Сохранить\n                  </Button>\n                </OverlayTrigger>\n              </div>\n            </div>\n          </Card.Body>\n        </Card>\n        <Card>\n          <Card.Title>Автомобили</Card.Title>\n          <Card.Header>\n            <Row className=\"spacer\">\n              <Col xs={12}>\n                <OverlayTrigger\n                  key={2}\n                  placement={this.tooltipPlace}\n                  overlay={\n                    <Tooltip id={`tooltip-2`}>Добавить автомобиль</Tooltip>\n                  }\n                >\n                  <Button\n                    variant=\"primary\"\n                    className=\"col\"\n                    name=\"add_car\"\n                    onClick={this.btnNewCarClick}\n                    disabled={this.state.owner.id < 0 ? \"disabled\" : \"\"}\n                  >\n                    Добавить автомобиль\n                  </Button>\n                </OverlayTrigger>\n              </Col>\n            </Row>\n          </Card.Header>\n          <div className=\"row spacer\">\n            <div className=\"col-12\">\n              <Cars\n                owner={this.state.owner.id}\n                withButtons=\"true\"\n                withOwnerInfo=\"false\"\n                withSearch=\"false\"\n              />\n            </div>\n          </div>\n        </Card>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}